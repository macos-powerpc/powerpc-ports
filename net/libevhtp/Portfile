# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           cmake 1.1
PortGroup           github 1.0
PortGroup           legacysupport 1.1
PortGroup           openssl 1.0

# _strndup
legacysupport.newest_darwin_requires_legacy 10

github.setup        Yellow-Camper libevhtp 1.2.18
revision            0
categories          net devel
license             BSD
maintainers         nomaintainer

description         Create extremely-fast and secure embedded HTTP servers
long_description    {*}${description} with ease.

checksums           rmd160  2552a4531110f4c8d6c2d0bbcd66402d0ed40c83 \
                    sha256  316ede0d672be3ae6fe489d4ac1c8c53a1db7d4fe05edaff3c7c853933e02795 \
                    size    208153
github.tarball_from archive

depends_build-append \
                    path:bin/pkg-config:pkgconfig
depends_lib-append  port:libevent

compiler.c_standard 1999

configure.args-append \
                    -DBUILD_SHARED_LIBS=ON

variant jemalloc description "Use Jemalloc" {
    patchfiles-append \
                    patch-find-jemalloc.diff
    depends_lib-append \
                    path:lib/pkgconfig/jemalloc.pc:jemalloc
    configure.args-append \
                    -DEVHTP_ALLOCATOR="jemalloc" \
                    -DEVHTP_USE_JEMALLOC=ON
}
