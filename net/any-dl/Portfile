# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0

github.setup        klartext any-dl eef829aadeec856df029194ec417a1730566bfc5
version             2025.12.22
revision            0
categories          net ocaml www
license             GPL-3
maintainers         {@barracuda156 macos-powerpc.org:barracuda} openmaintainer
description         ${name} is a generic mediathek-downloader
long_description    {*}${description}
checksums           rmd160  33eb5e844d29f42dfa8dc808768fba512ab8e7ed \
                    sha256  a862dde473684ad95faa2b36a9a0d5107c164b6cf43b8d60c3349cf06eeef378 \
                    size    91008
github.tarball_from archive

patchfiles          patch-fix-target.diff

depends_lib-append  path:lib/pkgconfig/gnutls.pc:gnutls \
                    port:ocaml \
                    port:ocaml-csv \
                    port:ocaml-ocamlnet \
                    port:ocaml-pcre \
                    port:ocaml-xmlm \
                    port:ocaml-yojson
depends_run-append  port:rtmpdump \
                    port:yt-dlp

use_configure       no

if {${configure.build_arch} in [list ppc ppc64]} {
    build.target    byte
}

# Error: Unbound module Parsetreetypes
use_parallel_build  no

destroot {
    copy ${worksrcpath}/${name} ${destroot}${prefix}/bin/
    xinstall -d ${destroot}${prefix}/share/${name}
    xinstall -m 644 ${worksrcpath}/README ${destroot}${prefix}/share/${name}/
    xinstall -m 644 ${worksrcpath}/rc-file.adl ${destroot}${prefix}/etc/any-dl.rc
}

notes "
You may need to copy config file from ${prefix}/etc/any-dl.rc to ~/.config/
"
