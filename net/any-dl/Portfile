# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0

github.setup        klartext any-dl 3b6c2498e83d189166953926a501f7fb230e5742
version             2025.02.03
revision            0
categories          net ocaml www
license             GPL-3
maintainers         {@barracuda156 macos-powerpc.org:barracuda} openmaintainer
description         ${name} is a generic mediathek-downloader
long_description    {*}${description}
checksums           rmd160  81633fb57b2879321cd59aa380ca1cde347b8c10 \
                    sha256  92b7e579575bb67c6e68f2331c72c379c69b007ab1eae4b0acdaddb12ffc4d9c \
                    size    90971
github.tarball_from archive

patchfiles          patch-fix-target.diff

depends_lib-append  path:lib/pkgconfig/gnutls.pc:gnutls \
                    port:ocaml \
                    port:ocaml-csv \
                    port:ocaml-ocamlnet \
                    port:ocaml-pcre \
                    port:ocaml-xmlm \
                    port:ocaml-yojson
depends_run-append  port:rtmpdump \
                    port:yt-dlp

use_configure       no
if {${configure.build_arch} in [list ppc ppc64]} {
    build.target    byte
}

destroot {
    copy ${worksrcpath}/${name} ${destroot}${prefix}/bin/
    xinstall -d ${destroot}${prefix}/share/${name}
    xinstall -m 644 ${worksrcpath}/README ${destroot}${prefix}/share/${name}/
    xinstall -m 644 ${worksrcpath}/rc-file.adl ${destroot}${prefix}/etc/any-dl.rc
}

notes "
You may need to copy config file from ${prefix}/etc/any-dl.rc to ~/.config/
"
