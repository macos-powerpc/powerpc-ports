# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           legacysupport 1.1
PortGroup           makefile 1.0

# strnlen
legacysupport.newest_darwin_requires_legacy 10

name                vgmi
github.setup        RealMelkor Vgmi cddb423ac74cfcf62364ef9cacaf81d2cbd558df
version             2.1-20251031
revision            0
categories          net gemini
license             ISC
maintainers         nomaintainer
description         Gemini client with vim-like keybindings
long_description    {*}${description}
homepage            https://rmf-dev.com/en/vgmi.html
checksums           rmd160  3c7df1ce2ebfd5c65c944781b2746b33943f4651 \
                    sha256  3cbd8982107f3ea0105dc6306813c716e58dba8176502650b06758d2faf4c315 \
                    size    291543
github.tarball_from archive
github.livecheck.branch lts-2.1

patchfiles          patch-GNUmakefile.diff

compiler.c_standard 2011

# libretls only needed with openssl
depends_lib         port:libretls \
                    path:lib/libssl.dylib:openssl

post-patch {
    reinplace "s|/usr/local|${prefix}|g" ${worksrcpath}/Makefile
}

build.target

destroot {
    copy ${worksrcpath}/${name} ${destroot}${prefix}/bin/
}

variant libressl description "Build with libressl" {
    depends_lib     path:lib/libssl.dylib:libressl
}
