--- src/communityid.bif	2025-08-20 16:36:43.000000000 +0800
+++ src/communityid.bif	2025-08-20 16:37:19.000000000 +0800
@@ -64,9 +64,10 @@
             // from Zeek's core, because there's no native SCTP support.
             // Assuming someone used 80/unknown for an SCTP conn_id record,
             // it still somehow works right.
+#ifdef IPPROTO_SCTP
             if ( hash_proto == IPPROTO_SCTP )
                 has_ports = true;
-
+#endif
             break;
         }
         default:
