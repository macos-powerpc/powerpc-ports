From 597d7c105d46d5c61c9d5f7f436f76f984fe23ce Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <vital.had@gmail.com>
Date: Tue, 11 Nov 2025 17:23:38 +0800
Subject: [PATCH] target.cpp: minor tweak re padding

---
 src/trans/target.cpp | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/src/trans/target.cpp b/src/trans/target.cpp
index 947f38eb..cc91e0fb 100644
--- a/src/trans/target.cpp
+++ b/src/trans/target.cpp
@@ -1087,7 +1087,7 @@ namespace {
             // >= 4 and up to 8 use embedding = 4. Skip ZST.
             if(Target_GetCurSpec().m_arch.m_name == "powerpc")
             {
-                if ( e.size > 0 )
+                if ( e.size > 0 && e.field != ~0u )
                 {
                     if( !is_first_field && align >= 4 && align <= 8 )
                     {
@@ -1096,7 +1096,8 @@ namespace {
                 }
             }
 
-            if ( e.size > 0 )
+            // Track first field for all architectures (only actual fields, not padding)
+            if ( e.size > 0 && e.field != ~0u )
             {
                 is_first_field = false;
             }
