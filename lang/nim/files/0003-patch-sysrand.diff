--- a/lib/std/sysrand.nim	2025-12-22 13:15:41.000000000 +0800
+++ b/lib/std/sysrand.nim	2025-12-22 13:18:38.000000000 +08000
@@ -66,7 +66,7 @@
   import std/assertions
 
 const
-  batchImplOS = defined(freebsd) or defined(openbsd) or defined(zephyr)
+  batchImplOS = defined(freebsd) or defined(openbsd) or defined(macosx) or defined(zephyr)
   batchSize {.used.} = 256
 
 when batchImplOS:
@@ -232,7 +232,16 @@
   proc getRandomImpl(p: pointer, size: int): int {.inline.} =
     result = getrandom(p, csize_t(size), 0)
 
-elif defined(ios) or defined(macosx):
+elif defined(macosx):
+  proc getentropy(p: pointer, size: cint): cint {.importc: "getentropy", header: "<sys/random.h>".}
+    # Fills a buffer with high-quality entropy,
+    # which can be used as input for process-context pseudorandom generators like `arc4random`.
+    # The maximum buffer size permitted is 256 bytes.
+
+  proc getRandomImpl(p: pointer, size: int): int {.inline.} =
+    result = getentropy(p, cint(size)).int
+
+elif defined(ios):
   {.passl: "-framework Security".}
 
   const errSecSuccess = 0 ## No error.
