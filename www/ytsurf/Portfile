# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0

github.setup        Stan-breaks ytsurf 3.1.4 v
revision            0
epoch               1
categories          www multimedia
platforms           any
license             GPL-3
maintainers         {@barracuda156 macos-powerpc.org:barracuda} openmaintainer
description         Shell script to search and play YouTube videos
long_description    Simple shell script to search YouTube videos from your terminal \
                    and play them with mpv
checksums           rmd160  2fee3ce1a4d3259984344d30cd1aa1acd068f5ef \
                    sha256  a75edd442b6ef68b02a7b6e38e7c0cb6f201335a31f4549a4c9186ef2047e994 \
                    size    27929
github.tarball_from archive
supported_archs     noarch

depends_run-append  port:bash \
                    port:chafa \
                    path:libexec/gnubin/sha256sum:coreutils \
                    port:curl \
                    path:bin/ffmpeg:ffmpeg \
                    path:bin/fzf:fzf \
                    port:jq \
                    path:bin/mpv:mpv \
                    path:bin/perl:perl5 \
                    port:sentaku \
                    port:yt-dlp

use_configure       no
build               { }
destroot {
    xinstall -m 775 ${worksrcpath}/ytsurf.sh ${destroot}${prefix}/bin/ytsurf
}

# OCaml is broken on ppc64 at the moment.
if {${os.platform} eq "darwin" && ${configure.build_arch} eq "ppc64"} {
    depends_run-delete  path:bin/fzf:fzf
}

# See: https://github.com/Stan-breaks/ytsurf/issues/13
notes "
    Add gnubin to the path:\
    `export PATH=${prefix}/libexec/gnubin:\$PATH`\
    \
    And run the app as `ytsurf --sentaku`.\
    \
    Consider also editing config file in ~/.config/ytsurf.

    Streaming videos may have issues on legacy systems.\
    However, searching and downloading works fine.

    As an alternative to sentaku, fzf or rofi can be used.\
    At the moment, fzf usage is highly experimental.
"
