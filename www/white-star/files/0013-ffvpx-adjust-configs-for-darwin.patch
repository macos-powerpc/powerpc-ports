From 5b95df13e521411e8d08a479ea87df98bbd72895 Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <barracuda@macos-powerpc.org>
Date: Mon, 15 Sep 2025 23:23:53 +0800
Subject: [PATCH 13/14] ffvpx: adjust configs for darwin

---
 media/ffvpx/config.h            |  2 +-
 media/ffvpx/config_darwin_ppc.h | 18 ++++++++++--------
 2 files changed, 11 insertions(+), 9 deletions(-)

diff --git a/media/ffvpx/config.h b/media/ffvpx/config.h
index 8c26afa9ee..216c5a8027 100644
--- a/media/ffvpx/config.h
+++ b/media/ffvpx/config.h
@@ -33,7 +33,7 @@
 #elif defined(XP_DARWIN)
 #if defined(__aarch64__)
 #include "config_darwin_aarch64.h"
-#elif defined(__ppc__)
+#elif defined(__POWERPC__)
 #include "config_darwin_ppc.h"
 #else
 #include "config_darwin64.h"
diff --git a/media/ffvpx/config_darwin_ppc.h b/media/ffvpx/config_darwin_ppc.h
index 33bbbe274c..958a756afc 100644
--- a/media/ffvpx/config_darwin_ppc.h
+++ b/media/ffvpx/config_darwin_ppc.h
@@ -3,10 +3,10 @@
 #define FFMPEG_CONFIG_H
 #define FFMPEG_CONFIGURATION "--disable-all --enable-avcodec --enable-decoder='vp8,vp9,flac' --enable-parser='vp8,vp9' --disable-static --enable-shared --disable-autodetect --disable-iconv --disable-linux-perf"
 #define FFMPEG_LICENSE "LGPL version 2.1 or later"
-#define CONFIG_THIS_YEAR 2024
-#define FFMPEG_DATADIR "/usr/local/share/ffmpeg"
-#define AVCONV_DATADIR "/usr/local/share/ffmpeg"
-#define CC_IDENT "gcc 13.3.0 (Adelie 13.3.0)"
+#define CONFIG_THIS_YEAR 2025
+#define FFMPEG_DATADIR "/opt/local/share/ffmpeg"
+#define AVCONV_DATADIR "/opt/local/share/ffmpeg"
+#define CC_IDENT "gcc 14.3.0 (MacOS PowerPC 14.3.0)"
 #define OS_NAME darwin
 #define av_restrict restrict
 #define EXTERN_PREFIX ""
@@ -31,7 +31,7 @@
 #define ARCH_MIPS64 0
 #define ARCH_PARISC 0
 #define ARCH_PPC 1
-#ifdef __powerpc64__
+#ifdef __ppc64__
 #define ARCH_PPC64 1
 #else
 #define ARCH_PPC64 0
@@ -304,8 +304,9 @@
 #define HAVE_WINRT 0
 #define HAVE_ACCESS 1
 #define HAVE_ALIGNED_MALLOC 0
-#define HAVE_ARC4RANDOM 1
-#define HAVE_CLOCK_GETTIME 1
+/* This is defined globally. */
+/* #define HAVE_ARC4RANDOM 1 */
+#define HAVE_CLOCK_GETTIME 0
 #define HAVE_CLOSESOCKET 0
 #define HAVE_COMMANDLINETOARGVW 0
 #define HAVE_FCNTL 1
@@ -339,7 +340,8 @@
 #define HAVE_MPROTECT 1
 #define HAVE_NANOSLEEP 1
 #define HAVE_PEEKNAMEDPIPE 0
-#define HAVE_POSIX_MEMALIGN 0
+/* This is defined globally. */
+/* #define HAVE_POSIX_MEMALIGN 0 */
 #define HAVE_PTHREAD_CANCEL 1
 #define HAVE_SCHED_GETAFFINITY 0
 #define HAVE_SECITEMIMPORT 0
-- 
2.50.1

