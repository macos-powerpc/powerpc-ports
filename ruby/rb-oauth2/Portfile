# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           ruby 1.0

# rb-multi_xml needs Ruby 3.2+
ruby.branches       3.4 3.3 3.2
ruby.setup          oauth2 2.0.12 gem {} rubygems
revision            0
categories-append   net devel
platforms           any
license             MIT
maintainers         nomaintainer
description         Ruby wrapper for the OAuth 2.0 protocol
long_description    {*}${description}
homepage            https://oauth2.galtzo.com
checksums           rmd160  c26a59571e37cba7862d49b8b04a709ff33d78c1 \
                    sha256  f7edb8549c7912724d07087d808c3fa6756298fd64d55d4968324df69c64ab3f \
                    size    57344
supported_archs     noarch

if {${subport} ne ${name}} {
    depends_run-append \
                    port:rb${ruby.suffix}-faraday \
                    port:rb${ruby.suffix}-jwt \
                    port:rb${ruby.suffix}-logger \
                    port:rb${ruby.suffix}-multi_xml \
                    port:rb${ruby.suffix}-rack \
                    port:rb${ruby.suffix}-snaky_hash \
                    port:rb${ruby.suffix}-version_gem

    # Verify this upon updating:
    post-destroot {
        # Fix rb-logger version:
        reinplace "s|~> 1.2|>= 1.2|g" ${destroot}${ruby.gemdir}/specifications/${ruby.module}-${version}.gemspec
        # Fix rb-multi_xml version:
        reinplace "s|~> 0.5|>= 0.5|g" ${destroot}${ruby.gemdir}/specifications/${ruby.module}-${version}.gemspec
    }
}
