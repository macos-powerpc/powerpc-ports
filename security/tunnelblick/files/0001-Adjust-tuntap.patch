From 7f3d92314ed8cd27ea5d8c61c7c2860e8527992b Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <vital.had@gmail.com>
Date: Tue, 20 Jan 2026 10:52:56 +0800
Subject: [PATCH 1/2] Adjust tuntap

---
 .../patches/03-UseMakeVariableForBuildArchitecture.diff   | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/third_party/sources/tuntap/tuntap-20111101/patches/03-UseMakeVariableForBuildArchitecture.diff b/third_party/sources/tuntap/tuntap-20111101/patches/03-UseMakeVariableForBuildArchitecture.diff
index 83644f73..a752245d 100644
--- a/third_party/sources/tuntap/tuntap-20111101/patches/03-UseMakeVariableForBuildArchitecture.diff
+++ b/third_party/sources/tuntap/tuntap-20111101/patches/03-UseMakeVariableForBuildArchitecture.diff
@@ -5,12 +5,12 @@
  INCLUDE = -I.. -I/System/Library/Frameworks/Kernel.framework/Headers
  CFLAGS = -Wall -mkernel -force_cpusubtype_ALL \
 -	-fno-builtin -fno-stack-protector -arch i386 -arch x86_64 \
-+	-fno-builtin -fno-stack-protector $(TUNTAP_ARCHS) \
++	-fno-builtin -fno-stack-protector -arch ppc -arch i386 -arch x86_64 \
  	-DKERNEL -D__APPLE__ -DKERNEL_PRIVATE -DTUNTAP_VERSION=\"$(TUNTAP_VERSION)\" \
  	-DTAP_KEXT_VERSION=\"$(TAP_KEXT_VERSION)\"
  CCFLAGS = $(CFLAGS)
 -LDFLAGS = -Wall -mkernel -nostdlib -r -lcc_kext -arch i386 -arch x86_64 -Xlinker -kext
-+LDFLAGS = -Wall -mkernel -nostdlib -r -lcc_kext $(TUNTAP_ARCHS) -Xlinker -kext
++LDFLAGS = -Wall -mkernel -nostdlib -r -lcc_kext -arch ppc -arch i386 -arch x86_64 -Xlinker -kext
  
  CCP = g++
  CC = gcc
@@ -22,12 +22,12 @@ diff -u -r -x .svn -x .DS_Store tuntap-20111101/tuntap/src/tun/Makefile tuntap-2
  INCLUDE = -I.. -I/System/Library/Frameworks/Kernel.framework/Headers
  CFLAGS = -Wall -mkernel -force_cpusubtype_ALL \
 -	-fno-builtin -fno-stack-protector -arch i386 -arch x86_64 \
-+	-fno-builtin -fno-stack-protector $(TUNTAP_ARCHS) \
++	-fno-builtin -fno-stack-protector -arch ppc -arch i386 -arch x86_64 \
  	-DKERNEL -D__APPLE__ -DKERNEL_PRIVATE -DTUNTAP_VERSION=\"$(TUNTAP_VERSION)\" \
  	-DTUN_KEXT_VERSION=\"$(TUN_KEXT_VERSION)\"
  CCFLAGS = $(CFLAGS)
 -LDFLAGS = -Wall -mkernel -nostdlib -r -lcc_kext -arch i386 -arch x86_64 -Xlinker -kext
-+LDFLAGS = -Wall -mkernel -nostdlib -r -lcc_kext $(TUNTAP_ARCHS) -Xlinker -kext
++LDFLAGS = -Wall -mkernel -nostdlib -r -lcc_kext -arch ppc -arch i386 -arch x86_64 -Xlinker -kext
  
  CCP = g++
  CC = gcc
