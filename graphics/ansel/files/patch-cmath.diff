--- src/common/math.h	2025-10-08 03:57:41.000000000 +0800
+++ src/common/math.h	2025-10-21 11:23:21.000000000 +0800
@@ -19,8 +19,18 @@
 #pragma once
 
 #include <stddef.h>
+
+#ifdef __cplusplus
+#include <cmath>
+#include <cstdint>
+
+using std::isfinite;
+using std::isinf;
+using std::isnan;
+#else
 #include <math.h>
 #include <stdint.h>
+#endif
 
 #include "common/darktable.h"
 
--- src/iop/lens.cc	2025-10-08 03:57:41.000000000 +0800
+++ src/iop/lens.cc	2025-10-21 11:21:43.000000000 +0800
@@ -40,11 +40,20 @@
 #include <assert.h>
 #include <ctype.h>
 #include <gtk/gtk.h>
-#include <inttypes.h>
-#include <math.h>
 #include <stdlib.h>
 #include <string.h>
 
+#ifdef __cplusplus
+#include <cinttypes>
+#include <cmath>
+
+using std::isfinite;
+using std::isnan;
+#else
+#include <inttypes.h>
+#include <math.h>
+#endif
+
 #include <lensfun.h>
 
 extern "C" {
