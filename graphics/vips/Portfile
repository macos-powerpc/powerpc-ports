# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           gobject_introspection 1.0
PortGroup           meson 1.0

github.setup        libvips libvips 8.18.0 v
revision            0
name                vips
distname            vips-${version}
description         VIPS is an image processing library.
long_description    {*}${description}. It is good \
                    for large images and color.
maintainers         {gmail.com:jcupitt @jcupitt} openmaintainer
categories          graphics
license             LGPL-2.1+
homepage            https://libvips.github.io/libvips
github.tarball_from releases

use_xz              yes

checksums           rmd160  b68566046d2204b0dbf5481130f3780bf71854f2 \
                    sha256  b85ab92280c30d22f5c8fe2f68b809cddb7eaac437d8c33474475dac84ddc574 \
                    size    30715488

depends_build       path:bin/doxygen:doxygen \
                    port:gtk-doc \
                    path:bin/pkg-config:pkgconfig

depends_lib         port:cfitsio \
                    port:expat \
                    port:fftw-3 \
                    path:lib/pkgconfig/glib-2.0.pc:glib2 \
                    port:hdf5 \
                    port:ImageMagick \
                    port:lcms2 \
                    port:libarchive \
                    port:libexif \
                    port:libgsf \
                    path:include/turbojpeg.h:libjpeg-turbo \
                    port:libjxl \
                    port:libpng \
                    path:lib/pkgconfig/librsvg-2.0.pc:librsvg \
                    port:libtool \
                    port:matio \
                    port:nifticlib \
                    port:openexr \
                    port:openslide \
                    port:orc \
                    path:lib/pkgconfig/pango.pc:pango \
                    path:lib/pkgconfig/poppler.pc:poppler \
                    port:tiff \
                    port:webp \
                    port:zlib

# meson.build: ERROR: C++ Compiler does not support -std=c++11
compiler.cxx_standard   2011

configure.post_args-append \
                   -Dintrospection=enabled

if {${os.platform} eq "darwin" && ${os.major} > 22} {
    if {[string match *clang* ${configure.compiler}]} {
        configure.cflags-append \
                    -Wno-error=incompatible-function-pointer-types
    }
}
