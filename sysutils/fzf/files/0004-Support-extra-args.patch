From 69f7e03bc1d51e3408b6114174399b4ec91eb4b5 Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <vital.had@gmail.com>
Date: Thu, 12 Feb 2026 02:56:56 +0800
Subject: [PATCH] Support extra args

diff --git fzf.ml fzf.ml
index ddbf227..95fbec8 100644
--- fzf.ml
+++ fzf.ml
@@ -4,16 +4,20 @@ open Async
 type t = {
   mutable items: string list
 ; mutable filtered_items : string list
+; prompt: string
+; header: string option
 ; mutable selected_index : int
 ; mutable all_filtered : string list
 ; spinner : Spinner.t
 ; mutable entered_text : string option
 }
 
-let create () =
+let create ~prompt ~header =
   {
     items = []
   ; filtered_items = []
+  ; prompt = prompt
+  ; header = header
   ; selected_index = 0
   ; all_filtered = []
   ; spinner = Spinner.create ~spin_every:(sec 0.2)
@@ -21,7 +25,7 @@ let create () =
   }
 
 let filter_items_and_selection t entered_text =
-  let { items; filtered_items = _; selected_index = _; all_filtered = _; spinner = _; entered_text = _} = t in
+  let { items; filtered_items = _; prompt = _; header = _; selected_index = _; all_filtered = _; spinner = _; entered_text = _} = t in
   t.entered_text <- entered_text;
   let filtered_items =
     match entered_text with
@@ -44,7 +48,7 @@ let get_selected t =
 
 let widget t screen =
   let open Tty_text in
-  let {items = _; filtered_items = _; selected_index; all_filtered; spinner; entered_text } = t in
+  let {items = _; filtered_items = _; prompt; header = _; selected_index; all_filtered; spinner; entered_text } = t in
   let prompt_size = 1 in
   let item_count = screen.Screen_dimensions.height - prompt_size in
 
@@ -57,7 +61,7 @@ let widget t screen =
     |> List.rev  (* Reverse for display - last item at top *)
   in
   let selected_in_window = (List.length visible_items - 1) - (selected_index - visible_start) in
-  let editor = Widget.text ("> " ^ (Option.value ~default:"" entered_text))
+  let editor = Widget.text (prompt ^ (Option.value ~default:"" entered_text))
   in
   let lines =
     List.mapi visible_items ~f:(fun i text ->
@@ -121,7 +125,7 @@ let handle_input t input =
   | Escape -> (`Finished None)
 ;;
 
-let run user_input tty_text stdin =
+let run user_input tty_text stdin ~prompt ~header =
   let stdin_reader =
     Pipe.map ~f:(fun x -> `Stdin x) (Reader.lines stdin)
   in
@@ -134,7 +138,7 @@ let run user_input tty_text stdin =
       ; Pipe.map user_input ~f:(fun x -> `Input x)
       ; stdin_closed]
   in
-  let t = create () in
+  let t = create ~prompt ~header in
   let last_rendered : (string option * string list * int) ref = ref (None, [], 0) in
   let how_often_to_render = (sec 0.1) in
   Render.every
@@ -172,13 +176,19 @@ let () =
   Command_unix.run @@
   let open Command.Let_syntax in
   Command.async ~summary:"fzf" [%map_open
-    let () = return () in
+    let prompt = flag "--prompt" (optional_with_default "> " string)
+        ~doc:"STRING Prompt string (default: '> ')"
+    and header = flag "--header" (optional string)
+        ~doc:"STRING Header string"
+    and _preview = flag "--preview" (optional string)
+        ~doc:"STRING Preview command (not supported, ignored)"
+    in
     fun () ->
       let open Deferred.Let_syntax in
       let stdin = force Reader.stdin in
       match%bind
         Tty_text.with_rendering (fun (input, tty_text) ->
-            run input tty_text stdin)
+            run input tty_text stdin ~prompt ~header)
       with
       | None -> Deferred.unit
       | Some output ->
