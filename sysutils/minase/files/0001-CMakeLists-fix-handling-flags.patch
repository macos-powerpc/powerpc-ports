From 03ed4189abbade2ddc1c3e1acc6b5afb45dc48a7 Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <barracuda@macos-powerpc.org>
Date: Sat, 30 Aug 2025 18:02:10 +0800
Subject: [PATCH 1/2] CMakeLists: fix handling flags

---
 CMakeLists.txt | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 3901363..029ba2d 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -36,9 +36,14 @@ ENDIF()
 
 SET(CMAKE_INCLUDE_CURRENT_DIR ON)
 SET(CMAKE_CXX_STANDARD 11)
-SET(CMAKE_CXX_FLAGS "-fPIC -Wall")
+SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIC -Wall")
 SET(CMAKE_CXX_FLAGS_DEBUG "-g -pg")
-SET(CMAKE_CXX_FLAGS_RELEASE "-DNDEBUG -O3 -mtune=native -march=native -mfpmath=both")
+IF(CMAKE_SYSTEM_PROCESSOR MATCHES "ppc|power")
+  SET(NATIVE_OPTFLAGS "-mcpu=native -maltivec")
+ELSE()
+  SET(NATIVE_OPTFLAGS "-march=native -mfpmath=both")
+ENDIF()
+SET(CMAKE_CXX_FLAGS_RELEASE "-DNDEBUG -O3 -mtune=native ${NATIVE_OPTFLAGS}")
 
 ADD_EXECUTABLE(minase main.cpp termbox/termbox.c termbox/utf8.c)
 INCLUDE_DIRECTORIES(
-- 
2.48.0

