# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           cmake 1.1
PortGroup           github 1.0
PortGroup           qt4 1.0

github.setup        mhogomchungu sirikali 1.3.1
revision            0
categories          aqua fuse sysutils
license             GPL-3
maintainers         {@barracuda156 macos-powerpc.org:barracuda}
description         GUI front-end to sshfs, ecryptfs-simple, cryfs, gocryptfs, securefs, fscrypt and encfs
long_description    Qt/C++ {*}${description}.
homepage            https://mhogomchungu.github.io/sirikali
checksums           rmd160  15fbdcd5e224ac4d3c28bd1960be89e2e8cf65b6 \
                    sha256  9c065575b21d252b7b248703720692431fd3750d2f4331bd4290e38a79c6171a \
                    size    957928
github.tarball_from archive

installs_libs       no

post-extract {
    delete -f ${worksrcpath}/version
}

# changepassworddialog.cpp:32:10: fatal error: ui_changepassworddialog.h: No such file or directory
cmake.out_of_source no

patchfiles          patch-CMakeLists.txt

compiler.cxx_standard   2014

depends_build-append    port:nlohmann-json \
                        path:bin/pkg-config:pkgconfig
depends_lib-append      port:libgcrypt \
                        port:libpwquality \
                        port:libsecret

configure.args-append   -DINTERNAL_LXQT_WALLET=1 \
                        -DNOKDESUPPORT=1 \
                        -DNOSECRETSUPPORT=0 \
                        -DQT5=0

platform darwin {
    configure.args-append \
                        -DCMAKE_INSTALL_PREFIX=${applications_dir}
}

# lxqt_osx_keychain.cpp:158:52: error: invalid conversion from 'quint32*' {aka 'unsigned int*'} to 'UInt32*' {aka 'long unsigned int*'} [-fpermissive]
if {[string match *gcc* ${configure.compiler}]} {
    configure.cxxflags-append \
                    -fpermissive
}
