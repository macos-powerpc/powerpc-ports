From f5c2c8eb9c23d426fa1070d75ab5c49c20819692 Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <barracuda@macos-powerpc.org>
Date: Fri, 18 Jul 2025 01:23:41 +0800
Subject: [PATCH 2/2] Define GL_MAP_READ_BIT

---
 modules/video_filter/egl_pbuffer.c          | 4 ++++
 modules/video_filter/opengl_win_offscreen.c | 4 ++++
 2 files changed, 8 insertions(+)

diff --git modules/video_filter/egl_pbuffer.c modules/video_filter/egl_pbuffer.c
index 5d2d4b8ad8..4be05adc19 100644
--- modules/video_filter/egl_pbuffer.c
+++ modules/video_filter/egl_pbuffer.c
@@ -40,6 +40,10 @@
 
 #define BUFFER_COUNT 4
 
+#ifdef __APPLE__
+#define GL_MAP_READ_BIT 0
+#endif
+
 struct pbo_picture_context
 {
     struct picture_context_t context;
diff --git modules/video_filter/opengl_win_offscreen.c modules/video_filter/opengl_win_offscreen.c
index e9f66ef344..23e06b5cf0 100644
--- modules/video_filter/opengl_win_offscreen.c
+++ modules/video_filter/opengl_win_offscreen.c
@@ -30,6 +30,10 @@
 
 #define BUFFER_COUNT 4
 
+#ifdef __APPLE__
+#define GL_MAP_READ_BIT 0
+#endif
+
 struct wgl_vt {
     PFNWGLGETEXTENSIONSSTRINGARBPROC     GetExtensionsStringARB;
     PFNWGLCHOOSEPIXELFORMATARBPROC       ChoosePixelFormatARB;
-- 
2.49.0

