# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           python 1.0

name                animesnap
github.setup        YisusChrist AnimeSnap b7df36dabe9ce2f0c613c3882afba980c788c267
version             0.1.0-20251209
revision            0
categories-prepend  multimedia anime
platforms           any
license             MIT
maintainers         {@barracuda156 macos-powerpc.org:barracuda} \
                    openmaintainer
description         AnimeSnap helps you to identify the anime episode or even timestamp \
                    just from a screenshot of any scene from that episode
long_description    {*}${description}
checksums           rmd160  82ee4b8dc1ffdf232679dac1c2fae0f27a7807fd \
                    sha256  2e626314f0b64e3e9d154495c1d3a706d83207fb223cc03ceecfebb29b4d408a \
                    size    672271
github.tarball_from archive
supported_archs     noarch

# Prefer Qt4 where it works, but avoid on arm64 and non-Darwin:
if {${os.platform} eq "darwin" && ${build_arch} in [list i386 ppc ppc64 x86_64]} {
    # Due to Qt4-related python deps.
    python.default_version  310

    # Notice, builds of pyqt4 against qt4-mac and qt4-mac-devel are binary-incompatible.
    depends_lib-append \
                    port:py${python.version}-pyqt4 \
                    port:py${python.version}-qt4py
} else {
    # Some dependencies do not have 3.13 subports yet.
    python.default_version  312

    depends_lib-append \
                    port:py${python.version}-pyqt5 \
                    port:py${python.version}-qtpy
}
python.pep517_backend       poetry

patchfiles          0001-Use-lower-case-module-name.patch

post-patch {
    system -W ${worksrcpath} "mv AnimeSnap animesnap"
}

depends_lib-append  port:py${python.version}-certifi \
                    port:py${python.version}-chardet \
                    port:py${python.version}-core-helpers \
                    port:py${python.version}-decorator \
                    port:py${python.version}-filetype \
                    port:py${python.version}-idna \
                    port:py${python.version}-packaging \
                    port:py${python.version}-qdarkstyle \
                    port:py${python.version}-requests \
                    port:py${python.version}-rich \
                    port:py${python.version}-setuptools \
                    port:py${python.version}-urllib3 \
                    port:py${python.version}-validators
