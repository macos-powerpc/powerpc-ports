# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0
PortGroup           python 1.0

name                animesnap
github.setup        YisusChrist AnimeSnap 0e996c24b26741599a1f5abbc446b114364ec8f0
version             0.1.0-20251129
revision            0
categories-prepend  multimedia anime
platforms           any
license             MIT
maintainers         {@barracuda156 macos-powerpc.org:barracuda} \
                    openmaintainer
description         AnimeSnap helps you to identify the anime episode or even timestamp \
                    just from a screenshot of any scene from that episode
long_description    {*}${description}
checksums           rmd160  41bde77ad5267f440c8b2437b6b1974fd67543ea \
                    sha256  86e12397bdda89f3ed9cd9970e4dda37544680a62b6ee9ef2593f2230ad1d440 \
                    size    672968
github.tarball_from archive
supported_archs     noarch

# Prefer Qt4 where it works, but avoid on arm64 and non-Darwin:
if {${os.platform} eq "darwin" && ${build_arch} in [list i386 ppc ppc64 x86_64]} {
    # Due to Qt4-related python deps.
    python.default_version  310

    depends_lib-append \
                    port:py${python.version}-pyqt4 \
                    port:py${python.version}-qt4py
} else {
    # Some dependencies do not have 3.13 subports yet.
    python.default_version  312

    depends_lib-append \
                    port:py${python.version}-pyqt5 \
                    port:py${python.version}-qtpy
}
python.pep517_backend       poetry

patchfiles          0001-Use-lower-case-module-name.patch

post-patch {
    system -W ${worksrcpath} "mv AnimeSnap animesnap"
}

depends_lib-append  port:py${python.version}-certifi \
                    port:py${python.version}-chardet \
                    port:py${python.version}-core-helpers \
                    port:py${python.version}-decorator \
                    port:py${python.version}-filetype \
                    port:py${python.version}-idna \
                    port:py${python.version}-packaging \
                    port:py${python.version}-qdarkstyle \
                    port:py${python.version}-requests \
                    port:py${python.version}-rich \
                    port:py${python.version}-setuptools \
                    port:py${python.version}-urllib3 \
                    port:py${python.version}-validators
