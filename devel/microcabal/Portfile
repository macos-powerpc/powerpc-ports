# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4

PortSystem                  1.0
PortGroup                   github 1.0
PortGroup                   makefile 1.0

name                        microcabal
github.setup                augustss MicroCabal 722c9eef8cb4ab14eccfc40bbe4655021c15bb0f
version                     2025.12.28
revision                    0
categories                  devel haskell
maintainers                 {@barracuda156 macos-powerpc.org:barracuda}
license                     Apache-2

description                 Reimplementation of a subset of Cabal
long_description            {*}${description}.

checksums                   rmd160  ce7cef8062e7692dde7c5a6b078edd84f2ba7c2f \
                            sha256  f61533f2c6778f4362ee752218b142055aa65875882e85dafbffbf29d5d5baf1 \
                            size    35883
github.tarball_from         archive

patchfiles                  patch-makefile.diff

post-patch {
    reinplace "s|@MHS@|${prefix}/bin/mhs|" ${worksrcpath}/Makefile
    reinplace "s|@MHSDIR@|${prefix}/lib/mhs|" ${worksrcpath}/Makefile
}

depends_build               port:MicroHS

# Match MicroHS
compiler.blacklist-append   *gcc-4.*

build.target                bin/mcabal

universal_variant           no

destroot {
    xinstall -m 755 ${worksrcpath}/bin/mcabal ${destroot}${prefix}/bin/
}
