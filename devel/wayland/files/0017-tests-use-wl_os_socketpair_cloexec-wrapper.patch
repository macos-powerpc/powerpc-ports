From 4b8d8f4dff123f3a153bf75cc82895d8798c5d7f Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <vital.had@gmail.com>
Date: Thu, 6 Nov 2025 00:48:33 +0800
Subject: [PATCH 17/18] tests: use wl_os_socketpair_cloexec wrapper

---
 tests/client-test.c    | 2 +-
 tests/resources-test.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/tests/client-test.c b/tests/client-test.c
index 5589e5e..83bdead 100644
--- a/tests/client-test.c
+++ b/tests/client-test.c
@@ -185,7 +185,7 @@ TEST(client_destroy_removes_link)
 	struct client_destroy_listener destroy_listener;
 	int s[2];
 
-	assert(socketpair(AF_UNIX, SOCK_STREAM | SOCK_CLOEXEC, 0, s) == 0);
+	assert(wl_os_socketpair_cloexec(AF_UNIX, SOCK_STREAM, 0, s) == 0);
 	display = wl_display_create();
 	assert(display);
 	client = wl_client_create(display, s[0]);
diff --git a/tests/resources-test.c b/tests/resources-test.c
index 4a08446..5a01785 100644
--- a/tests/resources-test.c
+++ b/tests/resources-test.c
@@ -244,7 +244,7 @@ TEST(resource_destroy_iteration)
 		.notify = &resource_destroy_notify
 	};
 
-	assert(socketpair(AF_UNIX, SOCK_STREAM | SOCK_CLOEXEC, 0, s) == 0);
+	assert(wl_os_socketpair_cloexec(AF_UNIX, SOCK_STREAM, 0, s) == 0);
 	display = wl_display_create();
 	assert(display);
 	client = wl_client_create(display, s[0]);
-- 
2.24.3 (Apple Git-128)

