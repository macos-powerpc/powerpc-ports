# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4

PortSystem                  1.0
PortGroup                   github 1.0

# FIXME: does not build on 32-bit:
# errors.axe:45: error: type mismatch in call to 'std.errors.error.create':
# argument 1 expects type 'ref char' but got 'std__errors__error'
# This is likely because we currently have a handicapped Axe there due to upstream bug,
# see: https://github.com/axelang/axe/issues/9

github.setup                axelang saw f1e2095b52d2606b893019aaa9d363035e2f8539
version                     2025.12.19
revision                    0
categories                  devel
maintainers                 {@barracuda156 macos-powerpc.org:barracuda} openmaintainer
license                     GPL-3
description                 Build tool for Axe
long_description            {*}${description}
homepage                    https://axelang.org
checksums                   rmd160  8f0f74b93f7d712fe6c97ffc9973e482d379f8bf \
                            sha256  60459e85968c297a9be8767f0ee64462aeb9bf10a676ae5a32cd446f7276c259 \
                            size    18331
github.tarball_from         archive

depends_lib-append          port:axe

# Match Axe port
compiler.c_standard         2011

universal_variant           no

use_configure               no

set axe_root                ${prefix}/libexec/axe
build.env-append            AXE_HOME=${axe_root}
build.cmd                   ${axe_root}/axe
build.args                  ${name}.axe
build.target

destroot {
    xinstall -d ${destroot}${axe_root}
    xinstall -m 755 ${worksrcpath}/saw ${destroot}${axe_root}/
    ln -s ${axe_root}/${name} ${destroot}${prefix}/bin/${name}
}
