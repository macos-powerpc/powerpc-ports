# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           boost 1.0
PortGroup           cmake 1.1
PortGroup           github 1.0
PortGroup           legacysupport 1.1

boost.version       1.81

github.setup        google libphonenumber 9.0.17 v
revision            0
name                libphonenumber-cpp
license             Apache-2
description         Google's C++ library for parsing, formatting, storing \
                    and validating international phone numbers.
long_description    {*}${description}
maintainers         {devans @dbevans} openmaintainer
categories          devel

checksums           rmd160  59fe5e7f4401f1eaf84b51074e4c30d0c8282582 \
                    sha256  977a3be64308bf8faeb0138dd5c6dd06f55a1de400106e2c5502a44315de0ba2 \
                    size    13022470
github.tarball_from archive

worksrcdir          ${worksrcpath}/cpp

set gtest_srcdir    ${prefix}/src/googletest

depends_build-append \
                    port:gtest \
                    path:bin/pkg-config:pkgconfig

depends_lib-append  port:abseil \
                    path:lib/pkgconfig/icu-uc.pc:icu \
                    port:protobuf

configure.args-append \
                    -DABSL_PROPAGATE_CXX_STD=ON \
                    -DBUILD_TESTING=OFF \
                    -DGTEST_SOURCE_DIR=${gtest_srcdir} \
                    -DGTEST_INCLUDE_DIR=${gtest_srcdir}/include \
                    -DREGENERATE_METADATA=OFF \
                    -DUSE_STD_MAP=ON

compiler.cxx_standard       2017
configure.cxxflags-append   -std=c++17
compiler.thread_local_storage yes

test.run            yes
test.cmd            ./libphonenumber_test
test.target
