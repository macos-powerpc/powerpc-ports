--- CMakeLists.txt.orig	2025-10-04 09:35:08.000000000 +0800
+++ CMakeLists.txt	2025-10-04 09:38:20.000000000 +0800
@@ -4,7 +4,11 @@
 
 set(MG_CUSTOM_COMPILE_FLAGS)
 
-add_library(mongoose STATIC ${CMAKE_CURRENT_SOURCE_DIR}/mongoose.c)
+if (NOT BUILD_SHARED_LIBS)
+    add_library(mongoose STATIC ${CMAKE_CURRENT_SOURCE_DIR}/mongoose.c)
+else ()
+    add_library(mongoose ${CMAKE_CURRENT_SOURCE_DIR}/mongoose.c)
+endif ()
 
 if (__SWITCH__)
     list(APPEND MG_CUSTOM_COMPILE_FLAGS -D__SWITCH__)
@@ -22,4 +26,4 @@
 endif ()
 
 target_compile_options(mongoose PUBLIC ${MG_CUSTOM_COMPILE_FLAGS})
-target_include_directories(mongoose PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})
\ No newline at end of file
+target_include_directories(mongoose PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})
