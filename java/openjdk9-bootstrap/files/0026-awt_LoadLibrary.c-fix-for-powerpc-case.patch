From 363eb804d8fc5e2a7a44c259366d7878b8c489ec Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <vital.had@gmail.com>
Date: Mon, 21 Jul 2025 02:41:01 +0800
Subject: [PATCH 26/31] awt_LoadLibrary.c: fix for powerpc case

---
 .../unix/native/libawt/awt/awt_LoadLibrary.c           | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/jdk/src/java.desktop/unix/native/libawt/awt/awt_LoadLibrary.c b/jdk/src/java.desktop/unix/native/libawt/awt/awt_LoadLibrary.c
index 55fbd2324e..7af8c132c2 100644
--- a/jdk/src/java.desktop/unix/native/libawt/awt/awt_LoadLibrary.c
+++ b/jdk/src/java.desktop/unix/native/libawt/awt/awt_LoadLibrary.c
@@ -90,8 +90,14 @@ JNIEXPORT jboolean JNICALL AWTIsHeadless() {
  */
 
 #ifdef MACOSX
+#ifdef __POWERPC__
+  #define XAWT_PATH "/libawt_xawt.dylib"
+  #define DEFAULT_PATH XAWT_PATH
+  #define HEADLESS_PATH "/libawt_headless.dylib"
+#else
   #define LWAWT_PATH "/libawt_lwawt.dylib"
   #define DEFAULT_PATH LWAWT_PATH
+#endif
 #else
   #define XAWT_PATH "/libawt_xawt.so"
   #define DEFAULT_PATH XAWT_PATH
@@ -134,7 +140,7 @@ AWT_OnLoad(JavaVM *vm, void *reserved)
     fmProp = (*env)->NewStringUTF(env, "sun.font.fontmanager");
     CHECK_EXCEPTION_FATAL(env, "Could not allocate font manager property");
 
-#ifdef MACOSX
+#if defined(MACOSX) && !defined(__POWERPC__)
         fmanager = (*env)->NewStringUTF(env, "sun.font.CFontManager");
         tk = LWAWT_PATH;
 #else
@@ -150,7 +156,7 @@ AWT_OnLoad(JavaVM *vm, void *reserved)
         CHECK_EXCEPTION_FATAL(env, "Could not allocate set properties");
     }
 
-#ifndef MACOSX
+#if !defined(MACOSX) || defined(__POWERPC__)
     if (AWTIsHeadless()) {
         tk = HEADLESS_PATH;
     }
-- 
2.24.3 (Apple Git-128)

