From 7a033bc7e62010da85f1478197148f46680eba8d Mon Sep 17 00:00:00 2001
From: Diana Kalinichenko <dkalinichenko@janestreet.com>
Date: Thu, 29 May 2025 18:44:51 -0400
Subject: [PATCH] ppxlib.0.36.0

---
 ppx_quickcheck/expander/import.ml                  |  1 +
 ppx_quickcheck/expander/ppx_quickcheck_expander.ml | 11 ++++++-----
 ppx_quickcheck/expander/ppx_shrinker_expander.ml   |  2 +-
 3 files changed, 8 insertions(+), 6 deletions(-)

diff --git a/ppx_quickcheck/expander/import.ml b/ppx_quickcheck/expander/import.ml
index aaf2dbb..c942838 100644
--- a/ppx_quickcheck/expander/import.ml
+++ b/ppx_quickcheck/expander/import.ml
@@ -24,6 +24,7 @@ let short_string_of_core_type core_type =
   | Ptyp_poly _ -> "explicit polymorphic type"
   | Ptyp_package _ -> "first-class module type"
   | Ptyp_extension _ -> "ppx extension type"
+  | Ptyp_open _ -> "local module open"
 ;;
 
 (* little syntax helpers *)
diff --git a/ppx_quickcheck/expander/ppx_quickcheck_expander.ml b/ppx_quickcheck/expander/ppx_quickcheck_expander.ml
index e27f24b..0b99ffc 100644
--- a/ppx_quickcheck/expander/ppx_quickcheck_expander.ml
+++ b/ppx_quickcheck/expander/ppx_quickcheck_expander.ml
@@ -62,7 +62,8 @@
      | Ptyp_class _
      | Ptyp_alias _
      | Ptyp_poly _
-     | Ptyp_package _ -> unsupported ~loc "%s" (short_string_of_core_type core_type))
+     | Ptyp_package _
+     | Ptyp_open _ -> unsupported ~loc "%s" (short_string_of_core_type core_type))
 
 and observer_of_core_type core_type ~obs_env ~gen_env =
   let loc = { core_type.ptyp_loc with loc_ghost = true } in
@@ -98,7 +99,7 @@
   | Ptyp_variant (_, _, Some _) -> unsupported ~loc "polymorphic variant type with [<]"
   | Ptyp_extension (tag, payload) -> custom_extension ~loc tag payload
   | Ptyp_any -> Ppx_observer_expander.any ~loc
-  | Ptyp_object _ | Ptyp_class _ | Ptyp_alias _ | Ptyp_poly _ | Ptyp_package _ ->
+  | Ptyp_object _ | Ptyp_class _ | Ptyp_alias _ | Ptyp_poly _ | Ptyp_package _ | Ptyp_open _ ->
     unsupported ~loc "%s" (short_string_of_core_type core_type)
 ;;
 
@@ -130,7 +131,7 @@
   | Ptyp_variant (_, _, Some _) -> unsupported ~loc "polymorphic variant type with [<]"
   | Ptyp_extension (tag, payload) -> custom_extension ~loc tag payload
   | Ptyp_any -> Ppx_shrinker_expander.any ~loc
-  | Ptyp_object _ | Ptyp_class _ | Ptyp_alias _ | Ptyp_poly _ | Ptyp_package _ ->
+  | Ptyp_object _ | Ptyp_class _ | Ptyp_alias _ | Ptyp_poly _ | Ptyp_package _ | Ptyp_open _ ->
     unsupported ~loc "%s" (short_string_of_core_type core_type)
 ;;
 
diff --git a/ppx_quickcheck/expander/ppx_shrinker_expander.ml b/ppx_quickcheck/expander/ppx_shrinker_expander.ml
index 554f94c..71554ed 100644
--- a/ppx_quickcheck/expander/ppx_shrinker_expander.ml
+++ b/ppx_quickcheck/expander/ppx_shrinker_expander.ml
@@ -59,7 +59,7 @@ let variant
   [%expr
     Ppx_quickcheck_runtime.Base_quickcheck.Shrinker.create
       [%e
-        pexp_function
+        pexp_function_cases
           ~loc
           (List.map clauses ~f:(fun clause ->
              let loc = { (Clause.location clause) with loc_ghost = true } in
