# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem                  1.0
PortGroup                   github 1.0
PortGroup                   muniversal 1.1

github.setup                flintlib flint 3.4.0 v
revision                    0
categories                  math devel
license                     LGPL-2.1+
maintainers                 {mcalhoun @MarcusCalhoun-Lopez} openmaintainer
description                 Fast Library for Number Theory
long_description            FLINT is a C library for doing number theory

homepage                    https://www.flintlib.org

checksums                   rmd160  8d632801aa31b2fd2d4b25059115f56929a4d572 \
                            sha256  9497679804dead926e3affeb8d4c58739d1c7684d60c2c12827550d28e454a33 \
                            size    9234972

github.tarball_from         releases

patchfiles                  patch-MACH_TASK_BASIC_INFO.diff

# Autotools are explicitly preferred by upstream
# for anything but Windows. As of now (2024.04),
# CMake implementation has a number of bugs,
# and there is no interest to address them;
# instead, autotools build is advised, and it works.
# https://github.com/flintlib/flint/issues/1905
# https://github.com/flintlib/flint/pull/1906
# https://github.com/flintlib/flint/issues/1907

use_autoreconf              yes

compiler.cxx_standard           2011
compiler.thread_local_storage   yes

depends_lib-append          port:gmp \
                            port:mpfr \
                            port:ntl

# We do not want pre-built ports with -march.
configure.args-append       --disable-arch

configure.args-append       --with-ntl
# NTL requires C++11
configure.cxxflags-append   -std=c++11

build.args                  V=1

test.run                    yes
test.target                 check

livecheck.url               ${homepage}/downloads.html
